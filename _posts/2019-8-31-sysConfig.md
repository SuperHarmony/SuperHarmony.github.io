---
layout: post
title: "系统配置与性能评价"
subtitle: '上午和案例分析与论文都有可能'
author: "Hc"
header-style: text
header-img: "img/tag-bg.jpg"
tags:

  - 软考
  - 系统架构设计
---


<head>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
            inlineMath: [['$','$']]
            }
        });
    </script>
</head>


## 系统故障模型

### 故障的来源

> - 失效：硬件的物理改变。 
> - 故障：由于部件的失效、环境的物理干扰、操作错误或不正确的设计引起的硬件或软件中的错误状态。 
> - 错误（差错）：故障在程序或数据结构中的具体位置。

### 表现形式

> - 永久性：描述连续稳定的失效、故障或错误。在硬件中，永久性失效反映了不可恢复的物理改变。 
> - 间歇性：描述那些由于不稳定的硬件或变化着的硬件或软件状态所引起的、仅仅是偶然出现的故障或错误。 
> - 瞬时性：描述那些由于暂时的环境条件而引起的故障或错误。 

### 层次

逻辑级的故障模型（逻辑固定为 0 或固定为 1）

数据结构级的故障（**独立差错（位级） 算术差错（运算级） 单向差错**）

软件故障和软件差错 （**非法转移 误转移 死循环 空间溢出 数据执行 无理数据**、软件故障只与设计有关）

系统级的故障模型（功能错误，即系统输出与系统设计说明的不一致）

## 系统配置方法

容错技术是保证系统在某些组成部分出现故障或差错时仍能正常工作的技术。

通常根据不同的系统配置方法而采用相应容错技术：

- 单机容错技术
- 双机热备份技术
- 服务器集群技术

### 单机容错

 在单机容错技术中，提高系统工作可靠性的方法主要有自检技术和冗余技术。

- 自检
  - 系统在发生非致命性故障时能自动发现故障和确定故障的性质、部位，
  - 并自动采取措施更换和隔离产生故障的部件。

- 冗余
  - 硬件冗余（增加硬件）
  - 软件冗余（增加程序，如同时采用不同算法或不同人编制的程序）
  - 时间冗余（如指令重复执行、程序重复执行）
  - 信息冗余（如增加数据位）

### 双机热备份

双机热备份系统采用`“心跳”方法`保证主系统与备用系统的联系。所谓“心跳”，指的是主、从系统之间相互按照一定的时间间隔发送通信信号，表明各自系统当前的运行状态。一旦“心跳”信号表明主机系统发生故障，或者备用系统无法收到主机系统的“心跳” 信号，则系统的高可用性管理软件认为主机系统发生故障，立即将系统资源转移到备用系统上，备用系统替代主机工作，以保证系统正常运行和网络服务不间断。 

 双机热备份方案中，根据两台服务器的工作方式可以有三种不同的工作模式，即：

> 双机热备模式
>
> 双机互备模式
>
> 双机双工模式

 `双机热备模式`即目前通常所说的 active/standby 方式，active 服务器处于工作状态；而standby 服务器处于监控准备状态，服务器数据包括数据库数据同时往两台或多台服务器写入（通常各服务器采用 RAID 磁盘阵列卡），保证数据的即时同步。当 active 服务器出现故障时，通过软件诊测或手工方式将 standby 机器激活，保证应用在短时间内完全恢复正常使用。典型应用有证券资金服务器或行情服务器。这是目前采用较多的一种模式，但由于另外一台服务器长期处于后备的状态，所以浪费了一部分计算资源。 

 用户可以根据系统的重要性及终端用户对服务中断的容忍程度决定是否使用双机热备份。例如，网络中的用户最多能容忍多长时间恢复服务，如果服务不能很快恢复会造成什么样的后果作为是否采用双机热备份的根据。对于承担企业关键业务应用的服务器需要极高的稳定性和可用性，并需要提供每周 7（天）×24（小时）不间断服务的应用，推荐使用双机热备份。 

`双机互备模式`是两个相对独立的应用在两台机器同时运行，但彼此均设为备机，当某一台服务器出现故障时，另一台服务器可以在短时间内将故障服务器的应用接管过来，从而保证了应用的持续性，但**对服务器的性能要求比较高**。 

`双机双工模式`是集群的一种形式，两台服务器均处于活动状态，同时运行相同的应用，以保证整体系统的性能，也实现了负载均衡和互为备份，通常使用磁盘柜存储技术。Web 服务器或 FTP 服务器等用此种方式比较多。

### 服务器集群

集群技术指一组相互独立的服务器在网络中组合成为单一的系统工作，并以单一系统的模式加以管理。此单一系统为客户工作站提供高可靠性的服务。

## 可靠性分析与可靠度计算

### 相关基本概念

与可靠性相关的概念主要有：可靠度、可用度、可维度、平均无故障时间、平均故障修复时间及平均故障间隔时间等。 

- 可靠度。系统的可靠度 R(t)是指在 t=0 时系统正常的条件下，系统在时间区间[0,t] 内能正常运行的概率。 

-  可用度。系统的可用度 A(t)是指系统在时刻 t 可运行的概率。 (`失效率=1-可靠度`)

- 可维度。系统的可维度 M(t)是指系统失效后，在时间间隔内被修复的概率。 

- 平均无故障时间。可靠度为 R(t)的系统平均无故障时间（`Mean Time To Failure，MTTF`）定义为从 t=0 时到故障发生时系统的持续运行时间的期望值：$MTTF=1/\lambda,\lambda 为失效率$

- 平均故障修复时间。可用度为 A(t)的系统平均故障修复时间（`Mean Time To Repair，MTTR`）可以用类似于求 MTTF 的方法求得。 $MTTR=1/\mu，\mu 为修复率$

- 平均故障间隔时间。平均故障间隔时间（Mean Time Between Failure，MTBF）常常与 MTTF 发生混淆。因为两次故障（失败）之间必然有修复行为，因此，MTBF 中应包含 MTTR。对于可靠度服从指数分布的系统，从任一时刻 t 0 到达故障的期望时间都是相等的，因此有： `MTBF = MTTR + MTTF` 


![1567090870782](/img/PIC/1567090870782.png)

### 串联系统并联系统

![1567167276811](/img/PIC/1567167276811.png)

### N模冗余系统与混合系统

![1567167454708](/img/PIC/1567167454708.png)



## 性能评价方法

### 性能计算

![1567184156618](/img/PIC/1567184156618.png)

### 基准程序法

跑一段程序来评价系统的性能。

- Dhrystone基准程序
  - 编译器、CPU处理整数指令
- Linpack基准程序
  - 浮点加法和 浮点乘法
- Whetstone基准程序
  - 浮点运算、功能调用、 数组变址、条件转移和 超越函数
- SPEC基准程序
  - 系统整体性能
- TPC基准程序
  - 事务处理、数据库处理、企业 管理与决策支持系统

## 软件容错

![1567232828087](/img/PIC/1567232828087.png)

![1567233762615](/img/PIC/1567233762615.png)

![1567233885564](/img/PIC/1567233885564.png) 